os: windows
language: C++
before_install:
  - wget -q https://download.qt.io/official_releases/qt/5.13/5.13.2/qt-opensource-windows-x86-5.13.2.exe
install:
  - ./qt-opensource-windows-x86-5.13.2.exe --script ./.ci/qt_installer_windows.qs
script:
  - mkdir build
  - cd build
  - setx path "%path%;C:\Qt\5.13.2\msvc2017\bin"
  - set PATH="%PATH%;C:\Qt\5.13.2\msvc2017\bin"
  - cmake -DCMAKE_PREFIX_PATH="C:\Qt\5.13.2\msvc2017" ..
  - cmake --build .
#  - windeployqt ./editor.exe
  - dir C:\Qt\5.13.2\msvc2017\bin
  - 7z a -tzip editor.zip -r *
deploy:
  provider: releases
  skip_cleanup: true
  api_key: $GITHUB_TOKEN
  file: editor.zip
  on:
    tags: true
    draft: true
